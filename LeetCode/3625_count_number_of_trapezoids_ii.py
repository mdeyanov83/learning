from typing import List, Tuple
from collections import defaultdict
from math import gcd

class Solution:
    def normalize_slope(self, dx: int, dy: int) -> Tuple[int, int]:
        # Vertical line
        if dx == 0:
            return(1, 0)
        # Horizontal line
        elif dy == 0:
            return(0, 1)
        # all other cases
        else:
            g = gcd(abs(dy), abs(dx))
            dy //= g
            dx //= g
        # normalize sign (dx to be positive)
        if dx < 0:
            dy, dx = -dy, -dx
        return (dy, dx)

    def countTrapezoids(self, points: List[List[int]]) -> int:

        slope_count = defaultdict(int) # slope -> number of segments with same slope
        line_count = defaultdict(int) # line_key -> number of co-linear segments
        mid_map = defaultdict(lambda: defaultdict(int)) # midpoints -> (diagonal_slope -> count)
        n = len(points)

        # Hash every point pair by its reduced slope, normalized with GCD and fixed sign
        for i in range(n-1):
            x1, y1 = points[i]
            for j in range(i+1, n):
                x2, y2 = points[j]

                dy = y2 - y1
                dx = x2 - x1
                slope = self.normalize_slope(dy, dx)

                # count towards slope bucket
                slope_count[slope] += 1

                # calculate line_key (slope, val), where val = dy * x - dx * y (invariant)
                # use slope and value computed with that reduced slope
                dy_r, dx_r = slope
                # invariant value:
                val = dy_r * x1 - dx_r * y1
                line_key = (dy_r, dx_r, val)
                line_count[line_key] += 1

                # midpoint key and slope for diagonals (for parallelogram counting)
                mid_key = (x1 + x2, y1 + y2)
                mid_map[mid_key][slope] += 1

        # s = total pairs of same slope segments
        s = 0
        for val in slope_count.values():
            s += val*(val-1) // 2

        # l = total pairs of colinear segments (must subtract from s)
        l = 0
        for val in line_count.values():
            l += val*(val-1) // 2

        # p = number of paralellograms using midpoint groups
        # excluding colinear diagonal pairs
        p = 0
        for mid_key, slope_dict in mid_map.items():
            c = 0
            for count in slope_dict.values():
                c += count
            if c >= 2:
                total_pairs = c*(c-1) // 2
                colinear_diagonal_pairs = 0
                for count in slope_dict.values():
                    if count >= 2:
                        colinear_diagonal_pairs += count*(count-1) // 2
                p += total_pairs - colinear_diagonal_pairs
        print(s, l, p)
        return s - l - p

def main():
    sol = Solution()

    input = [[-500,-997],[-499,-995],[-498,-993],[-497,-991],[-496,-989],[-495,-987],[-494,-985],[-493,-983],[-492,-981],[-491,-979],[-490,-977],[-489,-975],[-488,-973],[-487,-971],[-486,-969],[-485,-967],[-484,-965],[-483,-963],[-482,-961],[-481,-959],[-480,-957],[-479,-955],[-478,-953],[-477,-951],[-476,-949],[-475,-947],[-474,-945],[-473,-943],[-472,-941],[-471,-939],[-470,-937],[-469,-935],[-468,-933],[-467,-931],[-466,-929],[-465,-927],[-464,-925],[-463,-923],[-462,-921],[-461,-919],[-460,-917],[-459,-915],[-458,-913],[-457,-911],[-456,-909],[-455,-907],[-454,-905],[-453,-903],[-452,-901],[-451,-899],[-450,-897],[-449,-895],[-448,-893],[-447,-891],[-446,-889],[-445,-887],[-444,-885],[-443,-883],[-442,-881],[-441,-879],[-440,-877],[-439,-875],[-438,-873],[-437,-871],[-436,-869],[-435,-867],[-434,-865],[-433,-863],[-432,-861],[-431,-859],[-430,-857],[-429,-855],[-428,-853],[-427,-851],[-426,-849],[-425,-847],[-424,-845],[-423,-843],[-422,-841],[-421,-839],[-420,-837],[-419,-835],[-418,-833],[-417,-831],[-416,-829],[-415,-827],[-414,-825],[-413,-823],[-412,-821],[-411,-819],[-410,-817],[-409,-815],[-408,-813],[-407,-811],[-406,-809],[-405,-807],[-404,-805],[-403,-803],[-402,-801],[-401,-799],[-400,-797],[-399,-795],[-398,-793],[-397,-791],[-396,-789],[-395,-787],[-394,-785],[-393,-783],[-392,-781],[-391,-779],[-390,-777],[-389,-775],[-388,-773],[-387,-771],[-386,-769],[-385,-767],[-384,-765],[-383,-763],[-382,-761],[-381,-759],[-380,-757],[-379,-755],[-378,-753],[-377,-751],[-376,-749],[-375,-747],[-374,-745],[-373,-743],[-372,-741],[-371,-739],[-370,-737],[-369,-735],[-368,-733],[-367,-731],[-366,-729],[-365,-727],[-364,-725],[-363,-723],[-362,-721],[-361,-719],[-360,-717],[-359,-715],[-358,-713],[-357,-711],[-356,-709],[-355,-707],[-354,-705],[-353,-703],[-352,-701],[-351,-699],[-350,-697],[-349,-695],[-348,-693],[-347,-691],[-346,-689],[-345,-687],[-344,-685],[-343,-683],[-342,-681],[-341,-679],[-340,-677],[-339,-675],[-338,-673],[-337,-671],[-336,-669],[-335,-667],[-334,-665],[-333,-663],[-332,-661],[-331,-659],[-330,-657],[-329,-655],[-328,-653],[-327,-651],[-326,-649],[-325,-647],[-324,-645],[-323,-643],[-322,-641],[-321,-639],[-320,-637],[-319,-635],[-318,-633],[-317,-631],[-316,-629],[-315,-627],[-314,-625],[-313,-623],[-312,-621],[-311,-619],[-310,-617],[-309,-615],[-308,-613],[-307,-611],[-306,-609],[-305,-607],[-304,-605],[-303,-603],[-302,-601],[-301,-599],[-300,-597],[-299,-595],[-298,-593],[-297,-591],[-296,-589],[-295,-587],[-294,-585],[-293,-583],[-292,-581],[-291,-579],[-290,-577],[-289,-575],[-288,-573],[-287,-571],[-286,-569],[-285,-567],[-284,-565],[-283,-563],[-282,-561],[-281,-559],[-280,-557],[-279,-555],[-278,-553],[-277,-551],[-276,-549],[-275,-547],[-274,-545],[-273,-543],[-272,-541],[-271,-539],[-270,-537],[-269,-535],[-268,-533],[-267,-531],[-266,-529],[-265,-527],[-264,-525],[-263,-523],[-262,-521],[-261,-519],[-260,-517],[-259,-515],[-258,-513],[-257,-511],[-256,-509],[-255,-507],[-254,-505],[-253,-503],[-252,-501],[-251,-499],[-250,-497],[-249,-495],[-248,-493],[-247,-491],[-246,-489],[-245,-487],[-244,-485],[-243,-483],[-242,-481],[-241,-479],[-240,-477],[-239,-475],[-238,-473],[-237,-471],[-236,-469],[-235,-467],[-234,-465],[-233,-463],[-232,-461],[-231,-459],[-230,-457],[-229,-455],[-228,-453],[-227,-451],[-226,-449],[-225,-447],[-224,-445],[-223,-443],[-222,-441],[-221,-439],[-220,-437],[-219,-435],[-218,-433],[-217,-431],[-216,-429],[-215,-427],[-214,-425],[-213,-423],[-212,-421],[-211,-419],[-210,-417],[-209,-415],[-208,-413],[-207,-411],[-206,-409],[-205,-407],[-204,-405],[-203,-403],[-202,-401],[-201,-399],[-200,-397],[-199,-395],[-198,-393],[-197,-391],[-196,-389],[-195,-387],[-194,-385],[-193,-383],[-192,-381],[-191,-379],[-190,-377],[-189,-375],[-188,-373],[-187,-371],[-186,-369],[-185,-367],[-184,-365],[-183,-363],[-182,-361],[-181,-359],[-180,-357],[-179,-355],[-178,-353],[-177,-351],[-176,-349],[-175,-347],[-174,-345],[-173,-343],[-172,-341],[-171,-339],[-170,-337],[-169,-335],[-168,-333],[-167,-331],[-166,-329],[-165,-327],[-164,-325],[-163,-323],[-162,-321],[-161,-319],[-160,-317],[-159,-315],[-158,-313],[-157,-311],[-156,-309],[-155,-307],[-154,-305],[-153,-303],[-152,-301],[-151,-299],[-150,-297],[-149,-295],[-148,-293],[-147,-291],[-146,-289],[-145,-287],[-144,-285],[-143,-283],[-142,-281],[-141,-279],[-140,-277],[-139,-275],[-138,-273],[-137,-271],[-136,-269],[-135,-267],[-134,-265],[-133,-263],[-132,-261],[-131,-259],[-130,-257],[-129,-255],[-128,-253],[-127,-251],[-126,-249],[-125,-247],[-124,-245],[-123,-243],[-122,-241],[-121,-239],[-120,-237],[-119,-235],[-118,-233],[-117,-231],[-116,-229],[-115,-227],[-114,-225],[-113,-223],[-112,-221],[-111,-219],[-110,-217],[-109,-215],[-108,-213],[-107,-211],[-106,-209],[-105,-207],[-104,-205],[-103,-203],[-102,-201],[-101,-199],[-100,-197],[-99,-195],[-98,-193],[-97,-191],[-96,-189],[-95,-187],[-94,-185],[-93,-183],[-92,-181],[-91,-179],[-90,-177],[-89,-175],[-88,-173],[-87,-171],[-86,-169],[-85,-167],[-84,-165],[-83,-163],[-82,-161],[-81,-159],[-80,-157],[-79,-155],[-78,-153],[-77,-151],[-76,-149],[-75,-147],[-74,-145],[-73,-143],[-72,-141],[-71,-139],[-70,-137],[-69,-135],[-68,-133],[-67,-131],[-66,-129],[-65,-127],[-64,-125],[-63,-123],[-62,-121],[-61,-119],[-60,-117],[-59,-115],[-58,-113],[-57,-111],[-56,-109],[-55,-107],[-54,-105],[-53,-103],[-52,-101],[-51,-99],[-50,-97],[-49,-95],[-48,-93],[-47,-91],[-46,-89],[-45,-87],[-44,-85],[-43,-83],[-42,-81],[-41,-79],[-40,-77],[-39,-75],[-38,-73],[-37,-71],[-36,-69],[-35,-67],[-34,-65],[-33,-63],[-32,-61],[-31,-59],[-30,-57],[-29,-55],[-28,-53],[-27,-51],[-26,-49],[-25,-47],[-24,-45],[-23,-43],[-22,-41],[-21,-39],[-20,-37],[-19,-35],[-18,-33],[-17,-31],[-16,-29],[-15,-27],[-14,-25],[-13,-23],[-12,-21],[-11,-19],[-10,-17],[-9,-15],[-8,-13],[-7,-11],[-6,-9],[-5,-7],[-4,-5],[-3,-3],[-2,-1],[-1,1]]

    print(sol.countTrapezoids(input))


if __name__ == "__main__":
    main()
